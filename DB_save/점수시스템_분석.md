# 점수 시스템 분석 및 개선 제안

## 📊 현재 점수 시스템 분석

### 현재 동작 방식

#### 1. 점수 계산
```python
# include 키워드가 매칭되면 가중치 합산
점수 = 0
for 키워드 in include_키워드들:
    if 키워드 in 상품명:
        점수 += 키워드.가중치

예시:
- "할로윈" (가중치 2.0) 매칭 → 점수 = 2.0
- "호박" (가중치 1.0) 매칭 → 점수 = 3.0
- "잭오랜턴" (가중치 1.5) 매칭 → 점수 = 4.5
```

#### 2. 점수 사용 (현재 로직)
```python
# filter_products_by_season 함수에서
detected_seasons = [(halloween, 4.5), (christmas, 2.0), ...]  # 점수 순으로 정렬

for season_id, score in detected_seasons:
    validity = _check_season_validity(...)
    if validity == "INCLUDE":
        score_min = season_info.get("score_min", 1)
        if score >= score_min:  # ⚠️ 단순히 최소값 이상인지만 확인
            is_valid = True
            break  # ⚠️ 첫 번째 유효한 시즌만 사용하고 종료
```

---

## ❌ 문제점

### 문제 1: 점수 정렬이 의미 없음
- **현재**: 점수가 높은 순으로 정렬하지만, 실제로는 첫 번째 유효한 시즌만 체크
- **결과**: 점수 순 정렬이 의미가 없음

### 문제 2: 점수 차이가 의미 없음
- **현재**: 점수 4.5든 2.0이든 `score_min` 이상이면 동일하게 처리
- **결과**: 점수의 차이가 실제 기능에 반영되지 않음

### 문제 3: 점수 시스템의 의도가 불명확
- **의도**: "상품이 얼마나 해당 시즌과 관련있는가"를 나타내려고 했을 것
- **현실**: 단순히 "최소값 이상인지"만 확인하는 플래그로 사용됨

### 문제 4: 여러 시즌 감지 시 처리 불완전
- **현재**: 점수가 높은 시즌 하나만 선택
- **문제**: 
  - 한 상품이 여러 시즌에 해당할 수 있음 (예: "크리스마스 겨울 코트")
  - 하지만 첫 번째 시즌만 확인하고 종료
  - 다른 시즌은 확인하지 않음

---

## 💡 현재 점수 시스템의 실제 의미

### 현재로서는 단순한 "필터링 플래그"
```
점수 >= score_min → 시즌으로 감지 ✅
점수 < score_min  → 시즌으로 감지 안 함 ❌
```

**실제 사용 예시:**
```
할로윈 시즌 설정:
- include: "할로윈" (가중치 2.0), "호박" (가중치 1.0)
- score_min: 2.0

상품명: "할로윈 호박 장식품"
→ 점수: 3.0
→ 3.0 >= 2.0 → 포함 ✅

상품명: "호박 장식품" (할로윈 없음)
→ 점수: 1.0
→ 1.0 < 2.0 → 제외 ❌
```

### 점수가 의미가 있는 경우

**시나리오 1: 여러 키워드 중 일부만 매칭**
```
키워드:
- "할로윈" (가중치 2.0) → 중요
- "호박" (가중치 1.0) → 보조
- "장식품" (가중치 0.5) → 일반

score_min: 2.0

상품명: "호박 장식품"
→ 점수: 1.5
→ 1.5 < 2.0 → 제외 (할로윈 키워드가 없어서)

상품명: "할로윈 장식품"
→ 점수: 2.5
→ 2.5 >= 2.0 → 포함 (할로윈 키워드가 있어서)
```

**시나리오 2: 키워드 중요도 구분**
```
score_min: 2.0

상품명: "할로윈 호박 잭오랜턴" (모든 키워드 포함)
→ 점수: 4.5 (높음)
→ 포함 ✅

상품명: "호박 장식품" (일부 키워드만)
→ 점수: 1.0 (낮음)
→ 제외 ❌
```

---

## 🤔 개선 방안

### 방안 1: 현재 시스템 유지 (단순화)
**장점**: 
- 이해하기 쉬움
- 충분히 기능함

**개선점**:
- 점수 정렬 제거 (의미 없음)
- 점수 계산 최적화

### 방안 2: 점수 시스템을 의미 있게 활용
**개선 아이디어**:

#### 아이디어 A: 점수 기반 우선순위
```python
# 여러 시즌이 감지될 때 점수가 높은 시즌 우선
# 예: "크리스마스 겨울 코트"
# - 크리스마스 시즌: 점수 3.0
# - 겨울 시즌: 점수 2.0
# → 크리스마스 시즌이 우선 (점수 높음)
```

#### 아이디어 B: 점수 기반 필터링 강도
```python
# 점수가 높을수록 더 확실한 시즌 상품
# 점수가 낮으면 불확실한 상품으로 처리
if score >= score_min * 2:  # 매우 확실
    포함 ✅
elif score >= score_min:     # 확실
    포함 ✅ (단, 우선순위 낮음)
else:                        # 불확실
    제외 ❌
```

#### 아이디어 C: 점수 로그 기록
```python
# 점수를 로그에 기록하여 디버깅 및 분석 용이
self._log(f"시즌 감지: {season_id}, 점수: {score}, 최소값: {score_min}")
```

---

## ✅ 권장 사항

### 현재 상태로도 충분히 기능함
- 점수 시스템은 **"시즌 키워드가 충분히 포함되어 있는가"**를 판단하는 용도로 작동
- `score_min`을 조정하여 필터링 강도를 제어 가능

### 개선이 필요한 부분
1. **점수 정렬 제거** (의미 없음)
2. **점수 로그 추가** (디버깅 용이)
3. **점수 시스템 설명 개선** (사용자 가이드)

---

## 📝 결론

### 현재 점수 시스템의 의미
✅ **"시즌 키워드 매칭 정도"를 나타내는 지표**
- 점수가 높다 = 더 많은/중요한 키워드가 매칭됨
- 점수가 낮다 = 적은 키워드만 매칭됨 또는 중요하지 않은 키워드만 매칭됨

### 점수 시스템이 필요한 이유
1. **키워드 중요도 구분**: 중요한 키워드(할로윈)와 보조 키워드(호박) 구분
2. **오감지 방지**: 단순히 "호박"만 있어도 시즌 상품으로 감지되는 것 방지
3. **유연한 필터링**: `score_min` 조정으로 필터링 강도 제어

### 개선 권장 사항
1. **점수 정렬 제거** (불필요)
2. **점수 로그 추가** (디버깅)
3. **가이드 문서 개선** (사용자 이해 향상)

---

## 💬 사용자 입장에서 보는 점수

### 현재 점수 시스템이 유용한 경우
✅ **여러 키워드를 조합하여 시즌 상품 판단**
- 예: "할로윈" + "호박" = 할로윈 시즌 상품 (확실)
- 예: "호박"만 = 할로윈 시즌 상품이 아닐 수 있음 (불확실)

✅ **키워드 중요도 구분**
- 예: "할로윈" (중요) vs "장식품" (일반)

✅ **필터링 강도 제어**
- `score_min`을 높이면 = 더 확실한 시즌 상품만 포함
- `score_min`을 낮추면 = 약간 관련 있는 상품도 포함

### 점수 시스템이 불필요해 보이는 경우
❌ **단순히 키워드 하나만 사용하는 경우**
- 예: "할로윈"만 있고 다른 키워드 없음
- 이 경우 가중치와 점수 시스템이 과할 수 있음

---

**작성일**: 2025-01-01
**분석 결과**: 점수 시스템은 현재로서도 의미가 있으나, 개선 여지 있음

