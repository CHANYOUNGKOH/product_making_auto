# 시즌 필터링 관리 GUI - 사용 방법 가이드

## 📋 목차
1. [초기 설정 및 Excel 파일 로드](#1-초기-설정-및-excel-파일-로드)
2. [시즌 관리](#2-시즌-관리)
3. [키워드 관리](#3-키워드-관리)
4. [데이터 저장 및 컴파일](#4-데이터-저장-및-컴파일)
5. [정보 확인 및 도움말](#5-정보-확인-및-도움말)

---

## 1. 초기 설정 및 Excel 파일 로드

### 1.1 프로그램 시작
1. `season_filter_manager_gui.py` 파일을 실행합니다
2. 프로그램 창이 열리면 기본 Excel 파일이 자동으로 로드됩니다 (같은 폴더에 `Season_Filter_Seasons_Keywords.xlsx` 파일이 있는 경우)

### 1.2 Excel 파일 선택 (필요한 경우)
1. 상단의 **"📁 Excel 파일"** 영역에서 **"📂 파일 선택"** 버튼을 클릭합니다
2. 파일 탐색기에서 `Season_Filter_Seasons_Keywords.xlsx` 파일을 선택합니다
3. 파일이 자동으로 로드되고 하단 로그창에 로드 정보가 표시됩니다

### 1.3 파일 다시 로드
- **"🔄 다시 로드"** 버튼을 클릭하여 Excel 파일을 다시 읽어옵니다
- 외부에서 Excel 파일을 수정한 경우 사용합니다

---

## 2. 시즌 관리

### 2.1 시즌 목록 확인
- **왼쪽 패널 "📋 시즌 목록"**에서 현재 등록된 모든 시즌을 확인할 수 있습니다
- 시즌 목록은 트리뷰 형식으로 표시됩니다 (시즌ID | 시즌명 | 기간)

### 2.2 시즌 선택 및 상세 정보 확인
1. 왼쪽 시즌 목록에서 원하는 시즌을 클릭합니다
2. **오른쪽 패널 "📝 시즌 상세 정보"**에 선택한 시즌의 상세 정보가 표시됩니다:
   - 시즌 기본 정보 (시즌ID, 시즌명, 기간 등)
   - 키워드 목록
   - 관련 정보

### 2.3 새 시즌 추가

**단계별 절차:**

1. **시즌 목록 패널 상단의 "➕ 시즌 추가" 버튼 클릭**
   - 새 시즌 추가 다이얼로그 창이 열립니다

2. **시즌 기본 정보 입력**
   - **시즌ID**: 영문 소문자, 숫자, 언더스코어(_)만 사용
     - 예: `halloween`, `christmas_2024`, `winter_coat`
     - 띄어쓰기는 자동으로 언더스코어로 변환됩니다
   - **시즌명**: 한글로 입력 가능
     - 예: `할로윈`, `크리스마스`, `겨울 시즌`
   - **시작일**: `MM-DD` 형식 (예: `10-01`, `12-25`)
     - 달력 아이콘이 있으면 달력 위젯 사용 가능
   - **종료일**: `MM-DD` 형식
   - **연도넘김**: 시즌이 연도를 넘어갈 경우 체크
     - 예: 겨울 시즌 (12-01 ~ 02-28)
   - **소싱시작일수**: 시즌 시작일 기준 며칠 전부터 소싱 시작할지
     - 기본값: 30일
   - **가공완료마감일수**: 시즌 종료일 기준 며칠 전까지 가공 완료해야 하는지
     - 기본값: 21일
   - **사용여부**: 현재 사용할 시즌인지 여부
     - ✅ 사용: 시즌 필터링에 포함
     - ❌ 사용 안 함: 시즌 필터링에서 제외

3. **"저장" 버튼 클릭**
   - 입력한 정보가 Excel 파일에 저장됩니다
   - 시즌 목록이 자동으로 새로고침됩니다

4. **시즌 선택**
   - 새로 추가한 시즌을 클릭하여 상세 정보를 확인합니다

### 2.4 시즌 수정

**단계별 절차:**

1. **수정할 시즌 선택**
   - 왼쪽 시즌 목록에서 수정하고 싶은 시즌을 클릭합니다

2. **"✏️ 시즌 수정" 버튼 클릭**
   - 시즌 수정 다이얼로그 창이 열립니다
   - 기존 정보가 자동으로 입력되어 있습니다

3. **정보 수정**
   - 원하는 항목만 수정합니다
   - 시즌ID는 수정할 수 없습니다 (고유 식별자)

4. **"저장" 버튼 클릭**
   - 수정된 정보가 Excel 파일에 저장됩니다

### 2.5 시즌 삭제

**단계별 절차:**

1. **삭제할 시즌 선택**
   - 왼쪽 시즌 목록에서 삭제하고 싶은 시즌을 클릭합니다

2. **"🗑️ 시즌 삭제" 버튼 클릭**
   - 삭제 확인 다이얼로그가 표시됩니다

3. **삭제 확인**
   - 경고 메시지를 확인하고 "예"를 클릭합니다
   - ⚠️ 삭제된 시즌은 복구할 수 없습니다

4. **삭제 완료**
   - 시즌과 관련된 키워드도 함께 삭제됩니다
   - 시즌 목록이 자동으로 새로고침됩니다

---

## 3. 키워드 관리

### 3.1 키워드 목록 확인
1. 시즌을 선택합니다
2. 오른쪽 상세 정보 패널의 **"키워드 목록"** 섹션에서 해당 시즌의 모든 키워드를 확인할 수 있습니다
3. 각 키워드는 다음 정보를 표시합니다:
   - 키워드명
   - 타입 (include/exclude/allowed)
   - 가중치 (include 타입만)

### 3.2 키워드 추가

**단계별 절차:**

1. **키워드를 추가할 시즌 선택**
   - 왼쪽 시즌 목록에서 시즌을 클릭합니다
   - 시즌을 선택하지 않으면 키워드를 추가할 수 없습니다

2. **"➕ 키워드 추가" 버튼 클릭**
   - 키워드 추가 다이얼로그 창이 열립니다

3. **키워드 정보 입력**
   - **키워드**: 상품명에서 찾을 단어
     - 예: `할로윈`, `호박`, `크리스마스`, `트리`
   - **타입**: 키워드의 역할 선택
     - **include (포함)**: 이 키워드가 있으면 시즌 상품으로 판단
       - 가중치를 설정할 수 있습니다 (기본값: 1.0)
     - **exclude (제외)**: 이 키워드가 있으면 시즌 상품에서 제외
     - **allowed (예외 허용)**: exclude 키워드가 있어도 허용하는 예외
   - **가중치**: include 타입만 설정 가능 (1.0이 기본값)
     - 숫자가 클수록 더 중요한 키워드
     - 예: `할로윈` 2.0, `호박` 1.0, `장식품` 0.5
   - **설명**: 키워드에 대한 메모 (선택 사항)

4. **"저장" 버튼 클릭**
   - 키워드가 Excel 파일에 저장됩니다
   - 시즌 상세 정보가 자동으로 새로고침됩니다

### 3.3 키워드 타입별 사용 예시

#### include (포함) 타입
- **용도**: 시즌 상품을 판단하는 핵심 키워드
- **예시**:
  - 할로윈 시즌: `할로윈`, `호박`, `유령`, `마녀`
  - 크리스마스 시즌: `크리스마스`, `트리`, `산타`, `선물`
- **가중치 설정**:
  - 핵심 키워드: 2.0 이상
  - 일반 키워드: 1.0 (기본값)
  - 보조 키워드: 0.5 이하

#### exclude (제외) 타입
- **용도**: 시즌 상품에서 제외하고 싶은 키워드
- **예시**:
  - `일반용`: "할로윈 호박 장식품 (일반용)" → 제외
  - `여름용`: 겨울 시즌에서 여름용 상품 제외
- **주의**: exclude는 include보다 우선순위가 높습니다

#### allowed (예외 허용) 타입
- **용도**: exclude로 차단했지만 특정 경우는 허용하고 싶을 때
- **예시**:
  - exclude: `일반용`
  - allowed: `장식용`
  - 결과: "할로윈 호박 장식품 (일반용)" → allowed가 있으므로 포함

---

## 4. 데이터 저장 및 컴파일

### 4.1 Excel 파일 저장

**단계별 절차:**

1. **"💾 Excel 저장" 버튼 클릭**
   - 현재 편집한 모든 내용이 Excel 파일에 저장됩니다
   - 저장 완료 메시지가 표시됩니다

2. **⚠️ 중요 사항**
   - 시즌이나 키워드를 추가/수정한 후 반드시 저장해야 합니다
   - 저장하지 않으면 변경 사항이 Excel 파일에 반영되지 않습니다

### 4.2 JSON 컴파일

**단계별 절차:**

1. **Excel 파일이 먼저 저장되어 있어야 합니다**
   - "💾 Excel 저장" 버튼을 먼저 클릭하세요

2. **"🔄 JSON 컴파일" 버튼 클릭**
   - Excel 파일의 내용을 JSON 형식으로 변환합니다
   - 같은 폴더에 `Season_Filter_Seasons_Keywords.json` 파일이 생성됩니다
   - 컴파일 완료 메시지가 표시됩니다

3. **JSON 파일 위치**
   - Excel 파일과 같은 폴더에 저장됩니다
   - 파일명: `Season_Filter_Seasons_Keywords.json`

4. **용도**
   - `data_export.py` 등 다른 프로그램에서 사용할 수 있는 형식
   - Excel 파일보다 빠르게 로드 가능

### 4.3 JSON 미리보기

**단계별 절차:**

1. **"👁️ JSON 미리보기" 버튼 클릭**
   - 현재 Excel 파일을 JSON으로 변환한 결과를 미리 볼 수 있습니다
   - 별도의 창이 열리며 JSON 내용이 표시됩니다

2. **용도**
   - JSON 컴파일 전에 결과를 확인
   - 데이터 구조 확인
   - 디버깅 및 검증

3. **⚠️ 참고**
   - 미리보기는 실제 JSON 파일을 생성하지 않습니다
   - 파일로 저장하려면 "🔄 JSON 컴파일" 버튼을 사용하세요

---

## 5. 정보 확인 및 도움말

### 5.1 Excel 구조 확인

**단계별 절차:**

1. **"ℹ️ Excel 구조 확인" 버튼 클릭**
   - Excel 파일의 구조 정보를 확인할 수 있는 창이 열립니다

2. **확인 가능한 정보**
   - Excel 파일 경로
   - 시트 목록 및 각 시트의 구조:
     - 행 수, 컬럼 수
     - 컬럼 목록
     - 데이터 타입
     - 샘플 데이터 (최대 5행)

3. **용도**
   - Excel 파일 구조 파악
   - 컬럼명 확인
   - 데이터 검증

### 5.2 용어 설명

**단계별 절차:**

1. **"📖 용어 설명" 버튼 클릭**
   - 용어 설명 도움말 창이 열립니다

2. **확인 가능한 내용**
   - 기본 용어 (시즌, 시즌ID, 시즌명 등)
   - 시즌 설정 용어 (시작일, 종료일, 연도넘김 등)
   - 키워드 설정 용어 (include, exclude, allowed, 가중치 등)
   - 가공 기간 용어 (소싱시작일수, 가공완료마감일수 등)

3. **자세한 내용**
   - 더 자세한 설명은 `시즌필터링_사용자_용어설명.md` 파일을 참고하세요

---

## 📝 로그 창

### 로그 확인
- 프로그램 하단의 **"📝 로그"** 창에서 작업 내역을 확인할 수 있습니다
- 표시되는 정보:
  - 파일 로드 상태
  - 시트 로드 정보
  - 작업 성공/실패 메시지
  - 오류 메시지

---

## 🔄 작업 흐름 예시

### 시나리오 1: 새 시즌 추가 및 키워드 설정

1. **Excel 파일 로드**
   - 프로그램 실행 또는 "📂 파일 선택" 버튼 클릭

2. **시즌 추가**
   - "➕ 시즌 추가" 버튼 클릭
   - 시즌 정보 입력 (시즌ID: `halloween`, 시즌명: `할로윈`, 기간: 10-01 ~ 10-31)
   - 저장

3. **키워드 추가**
   - 추가한 시즌 선택
   - "➕ 키워드 추가" 버튼 클릭
   - 키워드 추가 (`할로윈`, `호박`, `유령` 등)

4. **데이터 저장**
   - "💾 Excel 저장" 버튼 클릭

5. **JSON 컴파일**
   - "🔄 JSON 컴파일" 버튼 클릭

### 시나리오 2: 기존 시즌 수정

1. **시즌 선택**
   - 왼쪽 목록에서 수정할 시즌 클릭

2. **시즌 수정**
   - "✏️ 시즌 수정" 버튼 클릭
   - 정보 수정
   - 저장

3. **데이터 저장**
   - "💾 Excel 저장" 버튼 클릭

4. **JSON 컴파일**
   - "🔄 JSON 컴파일" 버튼 클릭

---

## ⚠️ 주의사항

1. **데이터 저장**
   - 변경 사항은 반드시 "💾 Excel 저장" 버튼을 클릭해야 Excel 파일에 저장됩니다
   - 저장하지 않고 프로그램을 종료하면 변경 사항이 사라집니다

2. **시즌ID**
   - 시즌ID는 수정할 수 없습니다 (고유 식별자)
   - 시즌ID를 변경하려면 새 시즌을 추가하고 기존 시즌을 삭제해야 합니다

3. **시즌 삭제**
   - 시즌을 삭제하면 관련된 모든 키워드도 함께 삭제됩니다
   - 삭제된 데이터는 복구할 수 없으므로 주의하세요

4. **Excel 파일 백업**
   - 중요한 데이터는 정기적으로 백업하세요
   - Excel 파일을 직접 편집하기 전에 복사본을 만드세요

---

## 💡 팁

1. **시즌ID 규칙**
   - 영문 소문자, 숫자, 언더스코어만 사용
   - 띄어쓰기는 자동으로 언더스코어로 변환됩니다

2. **키워드 관리**
   - 키워드는 핵심 단어만 추가하세요 (너무 많으면 오탐 가능)
   - include 타입의 가중치는 기본값(1.0)으로 충분한 경우가 많습니다

3. **가공 기간 설정**
   - 소싱시작일수: 보통 30일
   - 가공완료마감일수: 보통 21일
   - 시즌별로 조정 가능하지만, 너무 짧으면 준비 시간이 부족할 수 있습니다

4. **연도넘김 사용**
   - 겨울 시즌 (12-01 ~ 02-28)처럼 연도를 넘어가는 경우만 체크하세요
   - 같은 해 안에서 시작하고 끝나는 시즌은 체크하지 않습니다

---

## 📞 문제 해결

### Excel 파일을 찾을 수 없습니다
- "📂 파일 선택" 버튼을 클릭하여 파일을 직접 선택하세요
- 파일이 다른 폴더에 있는지 확인하세요

### 시즌이 목록에 나타나지 않습니다
- "🔄 다시 로드" 버튼을 클릭하여 Excel 파일을 다시 읽어오세요
- Excel 파일에 올바른 형식의 데이터가 있는지 확인하세요

### 키워드를 추가할 수 없습니다
- 먼저 시즌을 선택해야 합니다
- 왼쪽 시즌 목록에서 시즌을 클릭한 후 다시 시도하세요

### JSON 컴파일이 실패합니다
- 먼저 "💾 Excel 저장" 버튼을 클릭하여 Excel 파일을 저장하세요
- Excel 파일에 오류가 없는지 확인하세요 (Excel 구조 확인 버튼 사용)

---

## 📚 추가 자료

- **용어 설명**: 프로그램 내 "📖 용어 설명" 버튼 또는 `시즌필터링_사용자_용어설명.md` 파일
- **Excel 구조**: 프로그램 내 "ℹ️ Excel 구조 확인" 버튼

---

**마지막 업데이트**: 2024

